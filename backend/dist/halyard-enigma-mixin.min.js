/**
 * halyard.js v1.3.2
 * Copyright (c) 2019 QlikTech International AB
 * This library is licensed under MIT - See the LICENSE file for full details
 */

!function(e){"function"==typeof define&&define.amd?define(e):e()}(function(){"use strict";function c(e,t,n){return{type:e,message:t.message||t.qErrorString,item:n,qixError:t}}var e={types:"Global",init:function(e){e.config?e.api.Promise=e.config.Promise:e.api.Promise=e.Promise},extend:{createSessionAppUsingHalyard:function(t){var n=this;return n.createSessionApp().then(function(e){return n.setScriptAndReloadWithHalyard(e,t,!1)})},createAppUsingHalyard:function(e,n){var r=this;return r.createApp(e).then(function(e){var t=e.qAppId;return r.openDoc(t).then(function(e){return r.setScriptAndReloadWithHalyard(e,n,!0)})})},reloadAppUsingHalyard:function(t,n,r){var o=this;return o.openDoc(t).catch(function(e){return r&&1003===e.code?o.createApp(t).then(function(e){return o.openDoc(e.qAppId)}):o.Promise.reject(e)}).then(function(e){return o.setScriptAndReloadWithHalyard(e,n,!0)})},setScriptAndReloadWithHalyard:function(r,o,a){var i=[];return o.getConnections().forEach(function(t){var e=t.getQixConnectionObject();if(e){var n=r.createConnection(e).then(function(e){return e},function(e){if(!e.code||2e3!==e.code)throw c("Connection Error",e,t)});i.push(n)}}),this.Promise.all(i).then(function(){return r.getLocaleInfo().then(function(e){var t;return o.setDefaultSetStatements({ThousandSep:(t=e).qThousandSep,DecimalSep:t.qDecimalSep,MoneyThousandSep:t.qMoneyThousandSep,MoneyDecimalSep:t.qMoneyDecimalSep,MoneyFormat:t.qMoneyFmt,TimeFormat:t.qTimeFmt,DateFormat:t.qDateFmt,TimestampFormat:t.qTimestampFmt,FirstWeekDay:t.qFirstWeekDay,ReferenceDay:t.qReferenceDay,FirstMonthOfYear:t.qFirstMonthOfYear,CollationLocale:t.qCollation,MonthNames:t.qCalendarStrings.qMonthNames,LongMonthNames:t.qCalendarStrings.qLongMonthNames,DayNames:t.qCalendarStrings.qDayNames,LongDayNames:t.qCalendarStrings.qLongDayNames},!0),r.globalApi.configureReload(!0,!0,!1).then(function(){return r.setScript(o.getScript()).then(function(){return r.doReload().then(function(){return r.globalApi.getProgress(0).then(function(n){return 0!==n.qErrorData.length?r.checkScriptSyntax().then(function(e){if(0===e.length)throw c("Loading Error",n.qErrorData[0]);var t=o.getItemThatGeneratedScriptAt(e[0].qTextPos);throw c("Syntax Error",n.qErrorData[0],t)}):a?r.doSave().then(function(){return r}):r})})})})})})}}};module.exports=[e,{types:"Doc",init:function(e){var t={handle:-1,id:"Global",type:"Global"};e.config?t.genericType="Global":(t.customType="Global",t.delta=!0),e.api.globalApi=e.api.session.getObjectApi(t)}}]});
//# sourceMappingURL=halyard-enigma-mixin.min.js.map
